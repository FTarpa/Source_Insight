macro TwoWordFind(key){	// key:F5	// 搜索同时包括2个以上宏的mk文件		//_TempHeadF7(hbuf)	sFile = getTXTPath(0) # "\\si_param.h"	hbuf = OpenCache(sFile)		type = GetParamCacheType(hbuf, "Dir:")	if(type == 0)	{		msg ("搜索已完成，打开搜索结果")		//已经清空参数，打开搜索结果		sFile = getTXTPath(0) # "\\si_test.h"		//hbuf = OpenCache(sFile)		//setCurrentBuf(hbuf)		hbuf = OpenFile(sFile) 			SaveBuf(hbuf)	} 	else if(type == 1)	{		//已经添加参数，设置目录，并开始搜索		msg ("参数已添加，开始搜索")		hbuf = GetCurrentBuf()		pathName = GetBufName(hbuf)		SetProjectDir(hbuf, pathName)				ShellFind(pNil)	} 	else if(type == 2)	{		//已经搜索过，打开搜索结果		msg ("打开上次搜索结果")		sFile = getTXTPath(0) # "\\si_test.h"		//hbuf = OpenCache(sFile)		//setCurrentBuf(hbuf)		hbuf = OpenFile(sFile) 			SaveBuf(hbuf)	}}macro SetProjectDir(hbuf, pathName){	//添加参数(当前目录)		//_TempHeadF7(hbuf)		//spr:0,rda:1	var baseType	var softType	var name		//项目根目录(6531XX)	name = getBasePath(hbuf)		//项目类型(6531XX)	baseType = getBaseType(pathName)	if(baseType == 10 || baseType == 20 || baseType == 30)	{		//spr		softType = 0	}	else if(baseType == 40 || baseType == 50)	{		//rda		softType = 2	}	else	{		softType = 3	}		//ShellAddParam("Dir:@name@")	//ShellAddParam("Type:@sztype@")		sFile = getTXTPath(0) # "\\si_param.h"	hbuf = OpenCache(sFile)	//AppendBufLine(hbuf, "Param:@cur_sel@")	AppendBufLine(hbuf, "Dir:@name@")	AppendBufLine(hbuf, "Type:@softType@")		//setCurrentBuf(hbuf)	SaveBuf(hbuf)	CloseBuf(hbuf)}macro AddParam(key){	// key:F6,选择作为参数1,2		//_TempHeadF7(hbuf)	// 1.读入选择内容		hbuf = GetCurrentBuf()	sel = MGetWndSel(hbuf)	if (IsNoSelect(sel)) //未选择	{		msg ("清空参数")				//清空参数		ShellClearParam("")		stop	}	hbuf = GetWndBuf(hwnd)	cur_line = GetBufLine(hbuf, sel.lnFirst )	if(strlen(cur_line) < sel.ichLim)		sel.ichLim = sel.ichLim - 1	if(sel.ichFirst == sel.ichLim || 4095 == sel.ichLim)		stop	cur_sel = strmid(cur_line, sel.ichFirst, sel.ichLim)	//msg ("cur_sel.@cur_sel@")	//Add Param	msg ("添加参数")	ShellAddParam("Param:@cur_sel@")}