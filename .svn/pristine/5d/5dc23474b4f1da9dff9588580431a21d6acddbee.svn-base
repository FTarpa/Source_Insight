/*	key:F2	功能：	1. 未选中，在搜索结果界面，打开F1->9设置的mk文件；默认打开当前目录	2. 选中mk, 打开 project或target	3. 选中path，打开对应目录，	       例如： F:\6531DA\MS_MMI\source\mmi_app\app\audio	           选中source ,    打开F:\6531DA\MS_MMI\source	           选中mmi_app, 打开F:\6531DA\MS_MMI\source\mmi_app	4. 以上条件打开失败，打开当前目录、工程目录Fun list:	macro _TempHeadF2(hbuf){}OpenPath()Common:	AddLinkProjectName(hbuf)	OpenSROrOther(hbuf)	OpenProjectFile(hbuf, file1, file2, word)	OpenBuildDir(hbuf)	OpenDir(hbuf, path)	OpenTools(hbuf, path)	OpenToolsDownload(hbuf, isSetPath)	OpenF2Test(hbuf)*/macro OpenPath(){	//_TempHeadF2(hbuf)	var baseDir	var basePro	hwnd = GetCurrentWnd()	hbuf = GetCurrentBuf()	if (hwnd == 0)	{    	hbuf = OpenDefaultSR(hbuf)    	stop	}			szpathName = GetBufName(hbuf)	baseDir = getCurPath(hbuf)	sel = MGetWndSel(hbuf)	if (IsNoSelect(sel)) //未选择	{		//1.未选中,打开当前目录		ShellExecute("explore", "@baseDir@\\", "", "", 1)	}	else	{		cur_line = GetBufLine(hbuf, sel.lnFirst )				 //选中最后一行，带换行符会出错		if(strlen(cur_line) < sel.ichLim)			sel.ichLim = sel.ichLim - 1		if(sel.ichFirst == sel.ichLim || 4095 == sel.ichLim)			stop				//if head:project_		cur_sel = strmid(cur_line, sel.ichFirst, sel.ichLim)		cur_sel_len = strlen("@cur_sel@")		if(cur_sel_len>8)		{			if(strmid(cur_sel, 0, 8) == "project_")			{				cur_sel = strmid(cur_sel, 8, cur_sel_len)			}		}		ret = 0		//2.打开选中的完整path		if(ret == 0){			isP = 0			i = sel.ichFirst			while ( 0 <= i)			{				ch = AsciiFromChar(cur_line[i])				if (ch == 58) //: 58 根目录				{					isP = 1				}				else if(ch < 47 && ch != 43 && ch != 45) //( 40;空格 32;/ 47;+ 43;- 45;				{					break				}				else if(ch > 122) //} 125;				{					break				}				else //\ 92;_ 95;/ 47				{				}				i = i-1			}			curPath = strmid(cur_line, i + 1, sel.ichLim)			if (isP == 0){  //非根目录				svLen = strlen("{save}")				if(i + 1 > svLen)				{					if(strmid(cur_line, i - svLen + 1, i + 1)=="{save}")					{						curDir = cat(getSavePath(0) , "\\@curPath@")					}					else					{						//baseDir变量后面还要用到，添加新变量						curDir = cat(baseDir, "\\@curPath@")					}				}				else				{					//baseDir变量后面还要用到，添加新变量					curDir = cat(baseDir, "\\@curPath@")				}			}			else			{				curDir = curPath			}						//use "^" as space			curDir = ReplaceWord(curDir, "^", " ")						//msg ("curDir:" # "@curDir@~")			ret = ShellExecute("explore", "@curDir@\\", "", "", 1)			if(ret == 0){				baseDir2 = getBasePath(hbuf)				curDir = cat(baseDir2, "\\@curPath@")				ret = ShellExecute("explore", "@curDir@\\", "", "", 1)			}		}		//2.打开选中的project/target目录; make目录冲突，放在短目录后面		if(ret == 0){			basePro = getProjectPath(szpathName)			//msg ("cur_sel:" # cat(basePro, "\\@cur_sel@\\"))			ret = ShellExecute("explore", cat(basePro, "\\@cur_sel@\\"), "", "", 1)		}		//3.失败, 打开当前目录		if(ret == 0){			ret = ShellExecute("explore", "@baseDir@\\", "", "", 1)		}	}}macro AddLinkProjectName(hbuf){	//_TempHeadF2(hbuf)	var baseDir			szpathName = GetBufName(hbuf)	sel = MGetWndSel(hbuf)	if (!IsNoSelect(sel))	{		cur_line = GetBufLine(hbuf, sel.lnFirst )				 //选中最后一行，带换行符会出错		if(strlen(cur_line) < sel.ichLim)			sel.ichLim = sel.ichLim - 1		if(sel.ichFirst == sel.ichLim || 4095 == sel.ichLim)			stop					cur_sel = strmid(cur_line, sel.ichFirst, sel.ichLim)		cur_sel_len = strlen("@cur_sel@")		if(cur_sel_len>8)		{			if(strmid(cur_sel, 0, 8) == "project_")			{				cur_sel = strmid(cur_sel, 8, cur_sel_len-8)			}		}						path1 = cat(getProjectPath(szpathName), "\\@cur_sel@")		path2 = cat(getDesktopPath(0), 			"\\@cur_sel@")		//ShellAddLink(path1, path2)		ShellAddLinkCygwin(path1, path2)	}	else	{		return ""	}}//F1->F1macro OpenSROrOther(hbuf){	//_TempHeadF2(hbuf)	if(IsSRFile(hbuf))	{		//打开下一个窗口		CtrlQ()	}	else	{		OpenDefaultSR(hbuf)	}}macro OpenProjectFile(hbuf, file1, file2, word){	//_TempHeadF2(hbuf)	szpathName = GetBufName(hbuf)	basePro = getCurProject(szpathName)		hbuf0 = OpenExistFile(basePro # file1)	if (hbuf0 == hNil){		hbuf0 = OpenExistFile(basePro # file2)	}		if (hbuf0 == hNil){		ret = ShellExecute("explore", "@basePro@\\", "", "", 1)	}	else if(word!="")	{		ret = GotoNextMacroEx(hbuf0, word, 0, 0)	}}macro OpenProjectBase(hbuf){	sMsg = "open file : " # CharFromKey(13)	sMsg = sMsg # "1: " # getProjectFromList(30)  # CharFromKey(13)	sMsg = sMsg # "2: " # getProjectFromList(10)  # CharFromKey(13)	sMsg = sMsg # "3: " # getProjectFromList(20)  # CharFromKey(13)	sMsg = sMsg # "4: " # getProjectFromList(40)  # CharFromKey(13)	sMsg = sMsg # "5: " # getProjectFromList(50)  # CharFromKey(13)	sMsg = sMsg # "5: " # getProjectFromList(60)  # CharFromKey(13)	msg ("@sMsg@")		key = GetKey()	if(key>48 && key<=48+6)	{		if (key == 49) 		 //1		{			OpenDir(hbuf, getProjectFromList(30))		}		else if (key == 50) //2		{			OpenDir(hbuf, getProjectFromList(10))		}		else if (key == 51) //3		{			OpenDir(hbuf, getProjectFromList(20))		}		else if (key == 52) //4		{			OpenDir(hbuf, getProjectFromList(40))		}		else if (key == 53) //5		{			OpenDir(hbuf, getProjectFromList(50))		}		else if (key == 54) //6		{			OpenDir(hbuf, getProjectFromList(60))		}	}	else	{		msg (CharFromKey(key) # " @key@")	}}macro OpenDir(hbuf, path){	//_TempHeadF2(hbuf)	ShellExecute("explore", "@path@", "", "", 1)}macro OpenBuildDir(hbuf){	//_TempHeadF2(hbuf)	szpathName = GetBufName(hbuf)	//例如：F:\6531E_16A	basePro = getBasePath(hbuf)	//例如：SE039_.._F2	proName = getCurProjectName(szpathName)	//例如：F:\6531E_16A\build\SE039_.._F2_builddir	buildPath = "@basePro@\\build\\@proName@_builddir"	OpenDir(hbuf, buildPath)}//common no usemacro OpenTools(hbuf, path){	//_TempHeadF2(hbuf)	szpathName = GetBufName(hbuf)	basePro = getBasePath(hbuf)	path = basePro # path	ShellExecute("open", "@path@", "", "", 1)}//打开 ResearchDownload.exemacro OpenToolsDownload(hbuf, isSetPath){	//_TempHeadF2(hbuf)	szpathName = GetBufName(hbuf)	//例如：F:\6531E_16A	basePro = getBasePath(hbuf)	//1.设置下载路径	if(isSetPath)	{		//例如：SE039_.._F2		proName = getCurProjectName(szpathName)		iniRow = 87		//例如：F:\6531E_16A\tools\..		iniPath = basePro # "\\tools\\DEBUG_TOOL\\ResearchDownload\\Bin\\ResearchDownload.ini"		//例如：F:\6531E_16A\build\SE039_.._F2_builddir\img\SE039_.._F2.pac		iniVal = "packet=@basePro@\\build\\@proName@_builddir\\img\\@proName@.pac"		SaveProjectFile(iniRow, iniPath, iniVal)	}	//2.打开下载工具		path = basePro # "\\tools\\DEBUG_TOOL\\ResearchDownload\\Bin\\ResearchDownload.exe"	ShellExecute("open", "@path@", "", "", 1)}macro OpenPathTest(hbuf){		}